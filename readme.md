# Отчет

**ФИО:** Самсонов Артём Арменович  
**Группа:** БПИ238  

## Задание

Реализовать для родительского и дочернего процесса двухстороннюю связь с использованием только одного неименованного канала (pipe) и циклической организацией обмена посредством семафора Unix System V. При этом канал должен быть постоянно открытым. Интервал для обмена должен быть равен одной секунде. Обмен должен завершаться после поочередной передачи в каждую сторону по десять сообщений. По завершении обмена обеспечить корректное закрытие канала и удаление семафора.

### Опционально +2 балла:
Вместо десяти обменов организовать поочередный обмен, завершающийся посылкой сигнала прерывания с клавиатуры родительскому или дочернему процессу. При этом оба процесса должны корректно завершить работу с закрытием канала и удалением семафора.

---

## Решение

Программа реализует полноценный обмен сообщениями между родительским и дочерним процессами с использованием:
- одного **неименованного канала**;
- двух семафоров System V: `SEM_PARENT`, `SEM_CHILD`;
- **поочередной синхронизации** с помощью `semop`;
- обработкой сигнала `SIGINT` с помощью `signal`.

### Основная логика:

- Используется структура `Message` с полем `type`:
  - `1` — от родителя к потомку;
  - `2` — от потомка к родителю.
- Один канал используется и для чтения, и для записи.
- Процессы чередуются в передаче сообщений.
- Программа завершается корректно по нажатию `Ctrl+C`.

### Ключевые элементы:

- **pipe_fd** — массив дескрипторов `pipe`.
- **semaphore_id** — ID набора семафоров.
- **SIGINT** — обрабатывается через `signal` и глобальный флаг `terminate_flag`.
- Процессы завершаются при `terminate_flag == 1`.

---

## Запуск

### Компиляция:

```bash
gcc os_bonus.c -o os_bonus
```

### Результат:

```bash
kleshny@MacBook-Air-Artem-2 OS %  gcc os_bonus.c -o os_bonus && ./os_bonus
[Родитель] Процесс запущен
[Потомок] Процесс запущен
[Родитель] Отправлено: Сообщение от родителя 1
[Потомок] Получено: Сообщение от родителя 1
[Потомок] Отправлено: Сообщение от дочернего 1
[Родитель] Получено: Сообщение от дочернего 1
[Родитель] Отправлено: Сообщение от родителя 2
[Потомок] Получено: Сообщение от родителя 2
[Потомок] Отправлено: Сообщение от дочернего 2
[Родитель] Получено: Сообщение от дочернего 2
[Родитель] Отправлено: Сообщение от родителя 3
[Потомок] Получено: Сообщение от родителя 3
[Потомок] Отправлено: Сообщение от дочернего 3
[Родитель] Получено: Сообщение от дочернего 3
[Родитель] Отправлено: Сообщение от родителя 4
[Потомок] Получено: Сообщение от родителя 4
[Потомок] Отправлено: Сообщение от дочернего 4
[Родитель] Получено: Сообщение от дочернего 4
[Родитель] Отправлено: Сообщение от родителя 5
[Потомок] Получено: Сообщение от родителя 5
^C
Получен сигнал завершения (SIGINT)

Получен сигнал завершения (SIGINT)
[Потомок] Отправлено: Сообщение от дочернего 5
[Потомок] Получен сигнал завершения, начинаю завершение работы...
[Потомок] Начинаю очистку ресурсов...
[Потомок] Ресурсы очищены, завершаю работу.
[Родитель] Получен сигнал завершения, начинаю завершение работы...
[Родитель] Отправляю сигнал завершения потомку (PID: 88813)
[Родитель] Потомок завершил работу
[Родитель] Начинаю очистку ресурсов...
[Родитель] Семафор успешно удален
[Родитель] Ресурсы очищены, завершаю работу.
[Родитель] Программа успешно завершена
kleshny@MacBook-Air-Artem-2 OS % 
```